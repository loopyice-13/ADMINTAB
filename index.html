<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>âœˆ Aviator Admin</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
:root{
  --bg:#0b0f14;
  --panel:#121822;
  --border:#1e2633;
  --green:#00ff99;
  --yellow:#ffcc00;
  --red:#ff4d4d;
  --text:#eaeaea;
  --muted:#8a94a6;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,Arial;
  background:radial-gradient(circle at top,#0e1a24,#000);
  color:var(--text);
}
.layout{display:flex;min-height:100vh}

/* SIDEBAR */
.sidebar{
  width:240px;
  background:#0c1117;
  border-right:1px solid var(--border);
  padding:20px 14px;
}
.sidebar h2{
  margin-bottom:20px;
  text-shadow:0 0 12px var(--green);
}
.menu a{
  display:block;
  padding:10px 14px;
  border-radius:12px;
  color:#bbb;
  text-decoration:none;
  margin-bottom:6px;
  cursor:pointer;
}
.menu a.active{
  background:linear-gradient(45deg,#00ff99,#00c3ff);
  color:#000;
  font-weight:700;
}

/* MAIN */
.main{flex:1;padding:20px}
.topbar{
  margin-bottom:20px;
}
.topbar h1{
  margin:0;
  font-size:22px;
}
.panel{
  background:var(--panel);
  border:1px solid var(--border);
  border-radius:16px;
  padding:16px;
  box-shadow:0 0 30px rgba(0,255,153,.08);
}
.hidden{display:none}

/* TABLE */
table{width:100%;border-collapse:collapse;font-size:14px}
th,td{padding:10px;border-bottom:1px solid var(--border)}
th{color:var(--muted);font-size:12px;text-transform:uppercase}
.badge{
  padding:4px 10px;
  border-radius:10px;
  font-size:11px;
  font-weight:700;
}
.free{background:#1f2937;color:#9ca3af}
.vip{background:#143b2b;color:var(--green)}

.dot{
  width:10px;height:10px;border-radius:50%;
  display:inline-block;margin-right:6px;
}
.green{background:var(--green)}
.yellow{background:var(--yellow)}
.red{background:var(--red)}
</style>
</head>

<body>

<div class="layout">
  <aside class="sidebar">
    <h2>âœˆ Aviator Admin</h2>
    <nav class="menu">
      <a class="active" onclick="showTab('users')">ðŸ‘¤ Users</a>
      <a onclick="showTab('vip')">ðŸ’Ž VIP</a>
      <a onclick="showTab('keys')">ðŸ”‘ Keys</a>
    </nav>
  </aside>

  <main class="main">
    <div class="topbar">
      <h1 id="title">All Users</h1>
    </div>

    <!-- USERS -->
    <div id="users" class="panel">
      <table>
        <thead>
          <tr>
            <th>User</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody id="usersTable"></tbody>
      </table>
    </div>

    <!-- VIP -->
    <div id="vip" class="panel hidden">
      <table>
        <thead>
          <tr>
            <th>User</th>
            <th>VIP Level</th>
            <th>Key Used</th>
            <th>Activated</th>
            <th>Expires</th>
            <th>Signals</th>
          </tr>
        </thead>
        <tbody id="vipTable"></tbody>
      </table>
    </div>

    <!-- KEYS -->
    <div id="keys" class="panel hidden">
      <table>
        <thead>
          <tr>
            <th>Key</th>
            <th>Type</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody id="keysTable"></tbody>
      </table>
    </div>
  </main>
</div>

<script>
firebase.initializeApp({
  apiKey: "YOUR_NEW_API_KEY",
  authDomain: "aviator-bot-aec45.firebaseapp.com",
  projectId: "aviator-bot-aec45"
});
const db = firebase.firestore();

/* ALL REAL KEYS */
const ALL_KEYS = {
  lifetime: [
    "L1X7-B6P9-KF4J-7R1T","L2M8-Q7F1-9K3L-R5T2","L3N9-P4K8-F7R1-T2M5",
    "L4P1-K9T3-R5F8-M6L2","L5Q3-R1M7-K6F2-P8T4","L6R7-F3L5-P9T2-K1M8",
    "L7S2-K8P4-R3M9-T5F1","L8T4-P7F1-K2R6-M3L9","L9U1-R5K2-F8M3-T4P7",
    "L0V6-P3T8-K9L2-F5R1","L1W9-K4R7-M2P1-T8F3","L2X3-R6M1-F5K9-P7T2",
    "L3Y7-P2L8-K1R5-T6F4","L4Z2-K5F3-R9M4-P1T8","L5A1-P6K2-F7T3-R4M9"
  ],
  monthly: [
    "M1H8-T3K9-L2R5-P9Q4","M2J4-K8R2-P7F1-Q3L5","M3K7-R5T1-L9P3-F8M2",
    "M4L2-P9K4-R1M8-T6F3","M5M3-F2R6-K8T1-L7P6","M6N9-K1L5-P3R7-T4F8",
    "M7P1-T8F3-L6K2-R9M5","M8Q4-R7M2-P1K6-F3L9","M9R5-L3T9-K2F8-P4M7",
    "M0S8-P6K3-R4L1-T5F2"
  ],
  weekly: [
    "W1A9-Q2K8-R3T4-F7M1","W2B7-F9K3-Q8M4-6R2X","W3C4-R8K2-M1F7-P9T3",
    "W4D8-P7L3-F2K5-R6Q1","W5E1-K4R9-M7T2-F8P6","W6F3-T1M8-R5K4-Q7L2",
    "W7G9-L2F6-P8R1-T3K4","W8H2-R3M5-K9T4-Q6F7",
    "W9J5-P1K7-R4L8-T2M9","W0K8-F6R3-M2P9-Q1T5"
  ]
};

/* TAB SWITCH */
function showTab(t){
  document.querySelectorAll(".menu a").forEach(x=>x.classList.remove("active"));
  document.querySelector(`[onclick="showTab('${t}')"]`).classList.add("active");

  users.classList.add("hidden");
  vip.classList.add("hidden");
  keys.classList.add("hidden");

  document.getElementById(t).classList.remove("hidden");
  title.innerText = t==="users"?"All Users":t==="vip"?"VIP Users":"Activation Keys";
}

/* USERS + VIP */
db.collection("users").onSnapshot(snapshot=>{
  usersTable.innerHTML="";
  vipTable.innerHTML="";

  snapshot.forEach(doc=>{
    const u = doc.data();
    const name = u.username || u.telegram || "Unknown";

    // USERS = EVERYONE, ALWAYS FREE LABEL
    usersTable.innerHTML += `
      <tr>
        <td>${name}</td>
        <td><span class="badge free">FREE</span></td>
      </tr>
    `;

    // VIP TAB = ACTIVATED ONLY
    if (u.vipLevel && u.vipLevel !== "Free") {
      vipTable.innerHTML += `
        <tr>
          <td>${name}</td>
          <td>${u.vipLevel}</td>
          <td>${u.activatedKey || "-"}</td>
          <td>${u.vipActivatedAt
            ? new Date(u.vipActivatedAt.seconds*1000).toLocaleDateString()
            : "-"}</td>
          <td>${u.vipExpiresAt
            ? new Date(u.vipExpiresAt.seconds*1000).toLocaleDateString()
            : "-"}</td>
          <td>${u.usedVIP || 0}</td>
        </tr>
      `;
    }
  });
});

/* KEYS */
db.collection("vip_keys").onSnapshot(snapshot=>{
  keysTable.innerHTML="";
  const usedMap={};
  snapshot.forEach(doc=>usedMap[doc.id]=doc.data());

  Object.entries(ALL_KEYS).forEach(([type,keys])=>{
    keys.forEach(key=>{
      let status="Unused", color="red";
      const data=usedMap[key];

      if(data){
        if(data.expiresAt && data.expiresAt.seconds*1000<Date.now()){
          status="Expired"; color="yellow";
        } else {
          status="Active"; color="green";
        }
      }

      keysTable.innerHTML+=`
        <tr>
          <td>${key}</td>
          <td>${type.toUpperCase()}</td>
          <td><span class="dot ${color}"></span> ${status}</td>
        </tr>
      `;
    });
  });
});
</script>

</body>
</html>
